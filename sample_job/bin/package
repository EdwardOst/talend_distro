#!/usr/bin/env bash

set -e
set -u

script_path=$(readlink -e "${BASH_SOURCE[0]}")
script_dir="${script_path%/*}"

source "${script_dir}/talend-packager.sh"

util_path=$(readlink -e "${script_dir}/../util")
source "${util_path}"

declare artifactid="${1:-talend_app}"
declare groupid="${2:-com/talend/se/packager}"
declare manifest="${3:-manifest.cfg}"

declare usage="package.sh [ <artifact> [ <groupid> [ <manifest> ] ] ]"

[ -z "${artifactid}" ] && echo "Artifactid cannot be empty: ${usage}" 1>&2 && exit 1
[ -z "${groupid}" ] && echo "Groupid cannot be empty: ${usage}" 1>&2 && exit 1
[ -z "${manifest}" ] && echo "Manifest cannot be empty: ${usage}" 1>&2 && exit 1

talend_packager -m "${manifest}" -g "${groupid}" -a "${artifactid}"
